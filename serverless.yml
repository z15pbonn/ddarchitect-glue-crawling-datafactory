service: ddarchitect-glue-crawling-datafactory
frameworkVersion: '3'

provider:
  name: aws
  runtime: python3.9
  stage: ${opt:stage, 'preprod'}
  region: eu-west-1
  iam:
    role: ${self:custom.${self:provider.stage}.aws_lambda_role}
  deploymentBucket:
    name: ${self:custom.${self:provider.stage}.deployment_bucket}
    
package:
  exclude:
    - '**'
  include:
    - 'lambda_package/**'

functions:
  hello:
    name: ddarchitect-glue-crawling-datafactory-${self:provider.stage}
    handler: lambda_package.handler.hello
    memorySize : 128
    timeout: 900
    tags:
      PROJECT: ${self:custom.${self:provider.stage}.aws_project_tag}

plugins:
  - serverless-python-requirements
  - serverless-stage-manager

custom:
  stages:
    - preprod
    - prod
  pythonRequirements:
    pythonBin: python3
  preprod: ${file(serverless_config/preprod.yml)}
  prod: ${file(serverless_config/prod.yml)}
